<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Never-Ending Elevator — Chill Simulator</title>
<style>
:root{--bg:#0b0f12;--card:#0f1720;--accent:#7dd3fc;--muted:#94a3b8}
*{box-sizing:border-box;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
html,body{height:100%;margin:0;background:linear-gradient(180deg,#071029 0%, #0b0f12 60%);color:#e6eef6}
.app{height:100vh;display:grid;grid-template-columns:330px 1fr;gap:18px;padding:18px}
.panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:16px;box-shadow:0 8px 30px rgba(2,6,23,.6)}
.left{width:330px}
.title{font-weight:700;font-size:18px;margin-bottom:8px}
.controls{display:flex;gap:8px;margin-bottom:12px}
.btn{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit;cursor:pointer}
.btn.primary{background:linear-gradient(180deg,#0ea5a3,#0284c7);color:black;font-weight:700}
.status{font-size:13px;color:var(--muted);margin-bottom:12px}
.hud{display:flex;flex-direction:column;gap:12px}
.big{font-size:36px;font-weight:800;text-align:center;padding:18px 12px;background:linear-gradient(180deg, rgba(255,255,255,.02), transparent);border-radius:10px}
.canvas-wrap{position:relative;overflow:hidden;border-radius:12px}
.shaft{position:relative;height:calc(100vh - 56px);background:linear-gradient(180deg,#091123,#05060a);overflow:hidden;border-radius:12px}
.elevator{position:absolute;left:50%;transform:translateX(-50%);width:260px;height:160px;border-radius:10px;background:linear-gradient(180deg,#0b1220,#0f1725);box-shadow:0 12px 40px rgba(2,6,23,.6);display:flex;flex-direction:column;align-items:center;justify-content:center;border:2px solid rgba(255,255,255,0.03)}
.elevator .doors{width:100%;height:70%;display:flex}
.door{flex:1;background:linear-gradient(180deg,#081021,#0c1420);margin:6px;border-radius:6px}
.floor-strip{position:absolute;left:calc(50% + 160px);transform:translateX(-50%);top:20px;background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:8px;font-weight:700}
.floor-list{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:420px}
.floor{width:100%;height:120px;margin:10px 0;display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}
.floor .leftcol{display:flex;gap:12px;align-items:center}
.icon{width:64px;height:64px;border-radius:8px;flex-shrink:0;background:linear-gradient(180deg,#0ea5a3,#0284c7);display:flex;align-items:center;justify-content:center;font-weight:800}
.meta{font-size:13px}
.note{font-size:12px;color:var(--muted)}
.controls-bottom{display:flex;gap:8px;margin-top:12px}
.small{font-size:12px;padding:8px}
.footer{font-size:12px;color:var(--muted);margin-top:12px}
.music-btn{display:flex;gap:8px;align-items:center}
.direction-indicator{font-size:13px;text-align:center;color:var(--muted);margin-top:6px}
</style>
</head>
<body>
<div class="app">
  <div class="panel left">
    <div class="title">Never-Ending Elevator — Chill Simulator</div>
    <div class="status">Starts at surface. Pick a direction or let generator decide. Music available.</div>
    <div class="hud">
      <div class="big" id="current-floor">Surface</div>
      <div class="controls">
        <button class="btn" id="btn-up">Go Up</button>
        <button class="btn" id="btn-down">Go Down</button>
      </div>
      <div class="controls">
        <button class="btn" id="btn-random">Generative (random each floor)</button>
        <button class="btn" id="btn-stop">Stop</button>
      </div>
      <div class="music-panel">
        <div class="music-btn">
          <button class="btn primary" id="btn-music">Play Lofi</button>
          <div class="note">Source: YouTube</div>
        </div>
      </div>
      <div class="direction-indicator" id="direction">Direction: Idle</div>
      <div class="footer">Tips: press a direction to start. "Generative" randomly chooses up/down each floor. Enjoy the infinite ride : )</div>
    </div>
  </div>

  <div class="panel canvas-wrap">
    <div class="shaft" id="shaft">
      <div class="floor-strip" id="strip">Floor 0</div>
      <div class="floor-list" id="floor-list"></div>
      <div class="elevator" id="elevator" style="top:50%;margin-top:-80px;">
        <div style="font-weight:800;font-size:22px">Elevator</div>
        <div class="doors" style="width:90%">
          <div class="door"></div>
          <div class="door"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Hidden YouTube player (we'll control via API) -->
<div id="player-anchor" style="display:none;"></div>
<script>
/* Never-Ending Elevator — Single-file demo
   Features:
   - Up/Down controls to move forever (recycles floor elements)
   - Generative mode: random direction choice each floor
   - YouTube lofi playback via button
*/

const floorList = document.getElementById('floor-list');
const strip = document.getElementById('strip');
const currentFloorLabel = document.getElementById('current-floor');
const dirLabel = document.getElementById('direction');

let direction = 0; // -1 down, 0 idle, +1 up
let generative = false;
let speed = 0.6; // pixels per frame (feel free to tweak)
let offset = 0; // vertical offset for animation
let floorHeight = 140; // includes margin

// We'll keep a circular buffer of floor items
let midFloorIndex = 0; // integer floor at center (0 == surface)
let visibleCount = 12; // how many floor cards kept
let floors = [];

function randomSeededContent(n, floorNum){
  // Simple generative content based on floor number
  const absn = Math.abs(floorNum);
  if (floorNum === 0) return {title:'Surface', desc:'You are at the surface. Sun + birds.', icon:'S'};
  if (floorNum > 0){ // sky
    const themes = ['Cloud Gardens','Sky Ruins','Neon Observatory','Aerial Farms','Space Elevator Gateway','Storm Layer'];
    return {title:`Sky +${floorNum}`, desc:themes[absn % themes.length], icon:'\u2B06'};
  } else { // underground
    const themes = ['Magma Cavern','Subway of Echoes','Archive Vaults','Crystal Roots','Coal Tunnels','Deep Ocean Mix'];
    return {title:`Depth ${floorNum}`, desc:themes[absn % themes.length], icon:'\u2B07'};
  }
}

function createFloorElement(floorNum){
  const el = document.createElement('div');
  el.className = 'floor';
  el.dataset.floor = floorNum;
  const left = document.createElement('div'); left.className='leftcol';
  const icon = document.createElement('div'); icon.className='icon';
  const meta = document.createElement('div'); meta.className='meta';

  const info = randomSeededContent(floorNum, floorNum);
  icon.textContent = info.icon;
  meta.innerHTML = `<div style="font-weight:700">${info.title}</div><div class="note">${info.desc}</div>`;

  left.appendChild(icon);
  left.appendChild(meta);
  const right = document.createElement('div');
  right.innerHTML = `<div class="note">floor ${floorNum}</div><div style="font-weight:700">${(floorNum>0)?'Above':'Below'}</div>`;
  el.appendChild(left);
  el.appendChild(right);
  return el;
}

function populateInitial(){
  floorList.innerHTML='';
  floors = [];
  // We'll center midFloorIndex at 0 and create floors around it
  const half = Math.floor(visibleCount/2);
  for(let i = -half; i<=half; i++){
    const fnum = midFloorIndex + i;
    const el = createFloorElement(fnum);
    el.style.position='absolute';
    el.style.left='50%';
    el.style.transform='translateX(-50%)';
    el.style.top = (i*floorHeight) + 'px';
    floors.push({num:fnum,el});
    floorList.appendChild(el);
  }
}

populateInitial();

function recycle(direction){
  // direction: +1 means moving up (floors shift down), so we need to create new floor at top
  if(direction === 1){
    // remove bottom-most and add new top
    const removed = floors.pop();
    floorList.removeChild(removed.el);
    const topIndex = floors[0].num - 1;
    const el = createFloorElement(topIndex);
    el.style.position='absolute'; el.style.left='50%'; el.style.transform='translateX(-50%)'; el.style.top = (-Math.floor(visibleCount/2)*floorHeight) + 'px';
    floors.unshift({num:topIndex, el});
    floorList.insertBefore(el, floorList.firstChild);
    // shift all positions down by floorHeight to maintain continuity
    floors.forEach((f, idx)=>{ f.el.style.top = ((idx - Math.floor(visibleCount/2))*floorHeight) + 'px'; });
    midFloorIndex -= 1; // center floor number decreased
  } else if(direction === -1){
    // remove top-most and add new bottom
    const removed = floors.shift();
    floorList.removeChild(removed.el);
    const bottomIndex = floors[floors.length-1].num + 1;
    const el = createFloorElement(bottomIndex);
    el.style.position='absolute'; el.style.left='50%'; el.style.transform='translateX(-50%)'; el.style.top = (Math.floor(visibleCount/2)*floorHeight) + 'px';
    floors.push({num:bottomIndex, el});
    floorList.appendChild(el);
    floors.forEach((f, idx)=>{ f.el.style.top = ((idx - Math.floor(visibleCount/2))*floorHeight) + 'px'; });
    midFloorIndex += 1; // center floor number increased
  }
}

function updateLabels(){
  strip.textContent = `Floor ${midFloorIndex}`;
  currentFloorLabel.textContent = (midFloorIndex===0)?'Surface': (midFloorIndex>0?`Sky ${midFloorIndex}`:`Depth ${midFloorIndex}`);
}

// animation
let lastTime = 0;
function anim(time){
  if(!lastTime) lastTime = time;
  const dt = time - lastTime;
  lastTime = time;
  if(direction !== 0){
    // move the floor-list visually opposite to direction to simulate elevator moving
    offset += direction * speed * (dt/16); // normalize to 60fps
    // when offset exceeds floorHeight, recycle one floor
    if(offset > floorHeight){
      // direction +1 (up) should recycle top
      recycle(1);
      offset -= floorHeight;
      if(generative){
        // pick new direction randomly each time you're centered on a floor
        direction = (Math.random()>.5)?1:-1;
      }
    } else if(offset < -floorHeight){
      recycle(-1);
      offset += floorHeight;
      if(generative){ direction = (Math.random()>.5)?1:-1; }
    }
    // apply transform
    floorList.style.transform = `translateY(${offset}px)`;
    // update midFloorIndex label once per floor crossing
    // We approximate center by floors[Math.floor(visibleCount/2)].num
    updateLabels();
    dirLabel.textContent = `Direction: ${direction===1?'Up':'Down'}`;
  }
  requestAnimationFrame(anim);
}
requestAnimationFrame(anim);

// Controls
document.getElementById('btn-up').addEventListener('click', ()=>{ generative=false; direction=1; dirLabel.textContent='Direction: Up'; });
document.getElementById('btn-down').addEventListener('click', ()=>{ generative=false; direction=-1; dirLabel.textContent='Direction: Down'; });
document.getElementById('btn-stop').addEventListener('click', ()=>{ generative=false; direction=0; dirLabel.textContent='Direction: Idle'; });
document.getElementById('btn-random').addEventListener('click', ()=>{ generative=true; // start moving in a random dir immediately
  direction = (Math.random()>.5)?1:-1; dirLabel.textContent='Direction: Generative'; });

// OPTIONAL: click on a floor to teleport (for fun)
floorList.addEventListener('click', (e)=>{
  const f = e.target.closest('.floor');
  if(!f) return;
  const num = parseInt(f.dataset.floor,10);
  midFloorIndex = num;
  populateInitial();
  updateLabels();
});

/* YouTube player setup for music — we use the IFrame API so we can start playback after a user gesture.
   The music URL the user requested: https://www.youtube.com/watch?v=jfKfPfyJRdk
   Video ID: jfKfPfyJRdk
*/

let player;
function onYouTubeIframeAPIReady(){
  player = new YT.Player('player-anchor', {
    height: '0', width: '0', videoId: 'jfKfPfyJRdk', playerVars: { 'playsinline': 1, 'controls': 0, 'rel':0, 'modestbranding':1 }, events: { 'onReady': onPlayerReady }
  });
}

function onPlayerReady(e){
  // nothing yet — we will play on button press
}

// Ensure api loader
const tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
document.body.appendChild(tag);

let musicPlaying = false;
const btnMusic = document.getElementById('btn-music');
btnMusic.addEventListener('click', ()=>{
  if(!player){
    // tiny delay — possible the API hasn't inited yet but creating the player above ensures eventual readiness
    btnMusic.textContent = 'Loading...' ;
    setTimeout(()=>{ btnMusic.textContent = 'Play Lofi'; }, 1000);
    return;
  }
  if(!musicPlaying){
    player.playVideo();
    musicPlaying = true;
    btnMusic.textContent = 'Pause Lofi';
  } else {
    player.pauseVideo();
    musicPlaying = false;
    btnMusic.textContent = 'Play Lofi';
  }
});

// small accessibility: keyboard arrows
window.addEventListener('keydown', (e)=>{
  if(e.key === 'ArrowUp') { direction = 1; generative=false; }
  if(e.key === 'ArrowDown') { direction = -1; generative=false; }
  if(e.key === ' ') { direction = 0; }
});

// initial label
updateLabels();
</script>
</body>
</html>
